clc
clear all
close all

%Figure for 80 switches

h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41];
KeyFlowPMF = [0.0, 0.0, 0.0, 0.0016277807921866521, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.391209983722192e-05, 3.391209983722192e-05, 0.00020347259902333151, 0.00023738469886055346, 0.0005086814975583288, 0.0011869234943027672, 0.002238198589256647, 0.004001627780792187, 0.005629408572978839, 0.0074267498643516006, 0.004679869777536625, 0.001288659793814433, 0.0018651654910472057, 0.0027807921866521974, 0.007223277265328269, 0.011733586543678785, 0.025366250678241997, 0.0515124796527401, 0.09522517634291916, 0.13096852957135105, 0.12666169289202386, 0.15708084644601195, 0.15619913185024417, 0.13324064026044494, 0.06673901247965273, 0.0043068366793271836, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 0.0016277807921866521, 0.0, 0.0, 0.0, 0.00010173629951166576, 3.391209983722192e-05, 0.0, 0.00010173629951166576, 0.00023738469886055346, 0.0003052088985349973, 0.00040694519804666303, 0.0010512750949538796, 0.002204286489419425, 0.004205100379815518, 0.009088442756375475, 0.008376288659793814, 0.004645957677699404, 0.004612045577862181, 0.009258003255561585, 0.017871676614215952, 0.03547205642973413, 0.06857026587086272, 0.13761530113944656, 0.25098345089527946, 0.25155995659251223, 0.08488198589256647, 0.003899891481280521, 0.0015599565925122083, 0.002916440586001085, 0.004781606077048291, 0.010444926749864351, 0.014955236028214866, 0.012615301139446554, 0.016311720021703745, 0.017159522517634293, 0.014853499728703201, 0.006951980466630494, 0.0003391209983722192];

Bit_length = Bit_length + 1;

subplot(2,3,1);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(a) Forwarding label length (bits), 80 switches');
ylabel('PMF');

%Figure for 224 switches

%h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48];
KeyFlowPMF = [0.0, 0.0, 0.0, 0.00014389336193758952, 5.886546624719572e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.540607360799524e-06, 6.540607360799524e-06, 1.3081214721599048e-05, 1.3081214721599048e-05, 4.578425152559667e-05, 7.848728832959429e-05, 0.00015697457665918857, 0.000261624294431981, 0.0006409795213583534, 0.0010661189998103224, 0.0016286112328390814, 0.0020537507112910504, 0.001746342165333473, 0.0007652510612135443, 0.00043168008581276855, 0.0006933043802447495, 0.0015501239445094872, 0.002845164201947793, 0.005866924802637173, 0.011753471427356745, 0.023009856695292725, 0.04630750011446063, 0.0796580570471774, 0.10862640704815849, 0.12414072770797496, 0.13977931990764664, 0.1553328842116279, 0.15036856322478107, 0.10453198684029799, 0.03420737649698151, 0.002210725287950239, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 0.00014389336193758952, 5.886546624719572e-05, 0.0, 0.0, 6.540607360799524e-06, 1.962182208239857e-05, 3.924364416479714e-05, 7.194668096879476e-05, 9.810911041199285e-05, 0.00024200247234958239, 0.0004970861594207638, 0.0009156850305119333, 0.0017594233800550718, 0.0032245194288741653, 0.0033160879319253586, 0.002132237999620645, 0.0040551765636957044, 0.007770241544629834, 0.016606602089069993, 0.032356384613875244, 0.06401946484750574, 0.1307271193203001, 0.23946471669359218, 0.1865577437520848, 0.019196682603946604, 6.540607360799524e-06, 2.6162429443198095e-05, 1.962182208239857e-05, 0.00015043396929838906, 0.00022892125762798333, 0.00039897704900877096, 0.0007717916685743439, 0.0015697457665918857, 0.003132950925822972, 0.006409795213583533, 0.012819590427167066, 0.02291174758488073, 0.0315061056569713, 0.03560052586483181, 0.040381709845576264, 0.044835863458280736, 0.044292993047334375, 0.03129026561406492, 0.009850154685364083, 0.0005167079815031624];

Bit_length = Bit_length + 1;

subplot(2,3,2);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(b) Forwarding label length (bits), 224 switches');
ylabel('PMF');


%Figure for 432 switches

%h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52];
KeyFlowPMF = [0.0, 0.0, 0.0, 3.4035601238895884e-05, 1.7017800619447942e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.508900309723971e-06, 1.7017800619447942e-05, 1.7017800619447942e-05, 2.97811510840339e-05, 0.00010636125387154964, 0.00017017800619447941, 0.00033184711207923486, 0.0004509717164153705, 0.0006211497226098499, 0.0006509308736938838, 0.0005190429188931622, 0.0002595214594465811, 0.0002127225077430993, 0.0003658827133181308, 0.0005615874204417821, 0.0014507675028079372, 0.002939825057009632, 0.005696708757360199, 0.011367890813791226, 0.02296977638609986, 0.04390167114802083, 0.0763716347299275, 0.10690156904121711, 0.125987032435928, 0.14540859739287296, 0.15390047990197747, 0.14955668629386337, 0.10362989687212824, 0.041102242946121643, 0.004441645961675913, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 3.4035601238895884e-05, 1.7017800619447942e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 8.508900309723971e-06, 1.2763350464585957e-05, 2.5526700929171915e-05, 4.6798951703481845e-05, 4.2544501548619854e-05, 0.0001446513052653075, 0.00028079371022089104, 0.0005275518192028862, 0.0010593580885606343, 0.0012933528470780436, 0.0006849664749327797, 0.0012805894966134578, 0.002174024029134475, 0.004918144379020456, 0.009653347401381846, 0.019140771246724073, 0.0380518021850856, 0.07653755828596712, 0.15310915217317314, 0.2744205438889078, 0.1962662945440931, 0.017285830979204247, 4.2544501548619855e-06, 2.97811510840339e-05, 3.829005139375787e-05, 6.807120247779177e-05, 0.00010636125387154964, 0.00027653926006602906, 0.0005700963207515061, 0.0011401926415030121, 0.0022208229808379563, 0.004577788366631496, 0.008806711820564311, 0.01617541948878527, 0.02180831149382254, 0.025662843334127498, 0.029194036962662945, 0.03149144004628842, 0.030900071474762602, 0.02104676491610224, 0.008113236445321807, 0.0007530376774105715];

Bit_length = Bit_length + 1;

subplot(2,3,3);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(c) Forwarding label length (bits), 432 switches');
ylabel('PMF');

%Figure for 704 switches

%h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55];
KeyFlowPMF = [0.0, 0.0, 0.0, 1.937552677213412e-05, 9.68776338606706e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.458508924044705e-06, 3.2292544620223527e-06, 0.0, 1.291701784808941e-05, 9.68776338606706e-06, 1.937552677213412e-05, 4.8438816930335295e-05, 0.00010656539724673764, 0.00021313079449347528, 0.00032938395512628, 0.00037459351759459294, 0.00040365680775279414, 0.00024865259357572116, 0.0001162531606328047, 0.00010333614278471529, 0.00020667228556943057, 0.0004327200979109953, 0.0007911673431954764, 0.0017082756104098247, 0.003468219292212007, 0.007123735343221311, 0.013675892646664665, 0.027713461793075832, 0.0505927296565042, 0.08114147686723566, 0.10876129028091285, 0.12853724460633772, 0.14620772502252405, 0.1553884954580536, 0.13684288708265924, 0.09287981683668692, 0.03736570338006064, 0.005137743849077564, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 1.937552677213412e-05, 9.68776338606706e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.2292544620223527e-06, 3.2292544620223527e-06, 0.0, 1.6146272310111764e-05, 3.229254462022353e-05, 6.781434370246941e-05, 0.00011948241509482706, 0.00022281855787954235, 0.0004004275532907718, 0.0008363769056637894, 0.0005909535665500906, 0.00046178338806919647, 0.0010495077001572647, 0.0020376595655361047, 0.004304596197875796, 0.008170013788916552, 0.01665972376957332, 0.03350028578901989, 0.06673900196661597, 0.1328515285675996, 0.2563285314319483, 0.2667880866344387, 0.0472988901052414, 8.718987047460353e-05, 6.458508924044705e-06, 2.9063290158201176e-05, 3.552179908224588e-05, 8.396061601258117e-05, 0.00010979465170876, 0.00023573557572763177, 0.000503763696075487, 0.0009720055930687282, 0.002021513293225993, 0.004185113782780969, 0.007533850659898149, 0.012600550910811222, 0.017247448081661388, 0.020935256677290914, 0.02306979387668769, 0.02556923683029299, 0.022876038608966347, 0.01592345375223222, 0.006668410464076159, 0.0007943965976574989];

Bit_length = Bit_length + 1;

subplot(2,3,4);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(d) Forwarding label length (bits), 704 switches');
ylabel('PMF');


%Figure for 1040 switches

%h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58];
KeyFlowPMF = [0.0, 0.0, 0.0, 5.30032994553911e-06, 1.3250824863847775e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.650164972769555e-06, 1.590098983661733e-05, 2.120131978215644e-05, 3.9752474591543326e-05, 5.30032994553911e-05, 0.00011130692885632131, 0.0001643102283117124, 0.00019611220798494705, 0.00021466336279433394, 0.00026766666224972506, 0.00012985808366570818, 6.0953794373699765e-05, 0.00010335643393801264, 0.0001987623729577166, 0.0004054752408337419, 0.00089310559582334, 0.0017941616865649887, 0.003458465289464269, 0.006858626949527608, 0.01381000967310215, 0.02655465302715094, 0.04826480448407913, 0.07580796904607312, 0.10315237123510938, 0.12434044019240198, 0.1408509679727563, 0.14921753879178978, 0.1397193475293837, 0.10155167159155658, 0.05039023679224032, 0.01126055096929784, 7.155445426477799e-05, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 5.30032994553911e-06, 1.3250824863847775e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.30032994553911e-06, 2.650164972769555e-06, 1.060065989107822e-05, 1.8551154809386883e-05, 4.505280453708243e-05, 8.480527912862576e-05, 0.00016696039328448195, 0.0004160759007248201, 0.0005273828295811415, 0.00034982177640558126, 0.0004425775504525157, 0.000916957080578266, 0.0017199570673274412, 0.0034796666092464256, 0.006930181403792386, 0.01333828030794917, 0.026923025958365907, 0.05436813441636742, 0.10950216650986525, 0.21558827036983053, 0.31276716975631735, 0.12963281964302278, 0.004871003219950442, 2.650164972769555e-06, 2.650164972769555e-06, 1.3250824863847775e-05, 2.9151814700465103e-05, 5.30032994553911e-05, 4.505280453708243e-05, 0.00023056435263095126, 0.0004160759007248201, 0.0007181947076205494, 0.0015291451892880331, 0.002912531305073741, 0.005522943803251752, 0.008976108762770482, 0.01249817801158122, 0.01482767302264566, 0.016409821511389085, 0.018156280228444222, 0.016990207640425616, 0.01220931002954934, 0.00529767978056634, 0.0010309141744073568, 2.650164972769555e-06];

Bit_length = Bit_length + 1;

subplot(2,3,5);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(e) Forwarding label length (bits), 1040 switches');
ylabel('PMF');

%Figure for 1440 switches

%h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60];
KeyFlowPMF = [0.0, 0.0, 0.0, 0.0, 2.0999359519534653e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0999359519534653e-06, 4.1998719039069305e-06, 1.2599615711720792e-05, 1.4699551663674258e-05, 4.4098654991022774e-05, 7.979756617423169e-05, 9.869698974181287e-05, 0.00017219474806018416, 0.00016589494020432377, 0.00013229596497306832, 0.00014489558068478913, 9.239718188595248e-05, 5.249839879883664e-05, 0.00011339654140548713, 0.00020159385138753268, 0.0004304868701504604, 0.0008966726514841297, 0.0018521435096229566, 0.0037210865068615408, 0.00735607563969299, 0.01460925441774026, 0.028628426832981595, 0.048983106015266537, 0.07693745340767107, 0.10407702565071765, 0.12636364590879978, 0.14191157169706323, 0.14831007654266545, 0.13539337050219968, 0.09907707814911645, 0.04862401696748249, 0.01138585273149169, 0.00010919666950158021, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 0.0, 2.0999359519534653e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0999359519534653e-06, 0.0, 6.299807855860396e-06, 1.4699551663674258e-05, 2.309929547148812e-05, 5.4598334750790104e-05, 0.00010709673354962674, 0.0002561921861383228, 0.0004010877668231119, 0.00025829212209027623, 0.00021419346709925348, 0.0005417834756039941, 0.0009806700895622683, 0.0019109417162776535, 0.0037735849056603774, 0.007475771988954337, 0.015004042376707511, 0.030106781743156834, 0.06043615669722074, 0.12147919488455602, 0.2394493967933978, 0.31246626977877173, 0.09958316271353723, 0.0016358501065717496, 2.0999359519534653e-06, 8.399743807813861e-06, 1.4699551663674258e-05, 1.2599615711720792e-05, 5.4598334750790104e-05, 8.189750212618515e-05, 0.00020789365924339307, 0.0003905880870633446, 0.0007664766224630149, 0.0015014542056467277, 0.0028160141115695972, 0.005161642569901618, 0.007975556745519261, 0.01100996419609202, 0.013349292846568179, 0.014707951407482071, 0.015820917462017407, 0.014399260822544913, 0.009903297949412544, 0.004609359414537857, 0.0010142690647935238, 8.399743807813861e-06];

Bit_length = Bit_length + 1;

subplot(2,3,6);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(f) Forwarding label length (bits), 1440 switches');
ylabel('PMF');
