clc
clear all
close all

%Figure for 80 nodes

h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41];
KeyFlowPMF = [0.0, 0.0, 0.0, 0.0016277807921866521, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.391209983722192e-05, 3.391209983722192e-05, 0.00020347259902333151, 0.00023738469886055346, 0.0005086814975583288, 0.0011869234943027672, 0.002238198589256647, 0.004001627780792187, 0.005629408572978839, 0.0074267498643516006, 0.004679869777536625, 0.001288659793814433, 0.0018651654910472057, 0.0027807921866521974, 0.007223277265328269, 0.011733586543678785, 0.025366250678241997, 0.0515124796527401, 0.09522517634291916, 0.13096852957135105, 0.12666169289202386, 0.15708084644601195, 0.15619913185024417, 0.13324064026044494, 0.06673901247965273, 0.0043068366793271836, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 0.0016277807921866521, 0.0, 0.0, 0.0, 0.00010173629951166576, 3.391209983722192e-05, 0.0, 0.00010173629951166576, 0.00023738469886055346, 0.0003052088985349973, 0.00040694519804666303, 0.0010512750949538796, 0.002204286489419425, 0.004205100379815518, 0.009088442756375475, 0.008376288659793814, 0.004645957677699404, 0.004612045577862181, 0.009258003255561585, 0.017871676614215952, 0.03547205642973413, 0.06857026587086272, 0.13761530113944656, 0.25098345089527946, 0.25155995659251223, 0.08488198589256647, 0.003899891481280521, 0.0015599565925122083, 0.002916440586001085, 0.004781606077048291, 0.010444926749864351, 0.014955236028214866, 0.012615301139446554, 0.016311720021703745, 0.017159522517634293, 0.014853499728703201, 0.006951980466630494, 0.0003391209983722192];

Bit_length = Bit_length + 1;

subplot(2,3,1);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(a) Forwarding label length (bits), 224 nodes');
ylabel('PMF');


%Figure for 432 nodes

%h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52];
KeyFlowPMF = [0.0, 0.0, 0.0, 3.4035601238895884e-05, 1.7017800619447942e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.508900309723971e-06, 1.7017800619447942e-05, 1.7017800619447942e-05, 2.97811510840339e-05, 0.00010636125387154964, 0.00017017800619447941, 0.00033184711207923486, 0.0004509717164153705, 0.0006211497226098499, 0.0006509308736938838, 0.0005190429188931622, 0.0002595214594465811, 0.0002127225077430993, 0.0003658827133181308, 0.0005615874204417821, 0.0014507675028079372, 0.002939825057009632, 0.005696708757360199, 0.011367890813791226, 0.02296977638609986, 0.04390167114802083, 0.0763716347299275, 0.10690156904121711, 0.125987032435928, 0.14540859739287296, 0.15390047990197747, 0.14955668629386337, 0.10362989687212824, 0.041102242946121643, 0.004441645961675913, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 3.4035601238895884e-05, 1.7017800619447942e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 8.508900309723971e-06, 1.2763350464585957e-05, 2.5526700929171915e-05, 4.6798951703481845e-05, 4.2544501548619854e-05, 0.0001446513052653075, 0.00028079371022089104, 0.0005275518192028862, 0.0010593580885606343, 0.0012933528470780436, 0.0006849664749327797, 0.0012805894966134578, 0.002174024029134475, 0.004918144379020456, 0.009653347401381846, 0.019140771246724073, 0.0380518021850856, 0.07653755828596712, 0.15310915217317314, 0.2744205438889078, 0.1962662945440931, 0.017285830979204247, 4.2544501548619855e-06, 2.97811510840339e-05, 3.829005139375787e-05, 6.807120247779177e-05, 0.00010636125387154964, 0.00027653926006602906, 0.0005700963207515061, 0.0011401926415030121, 0.0022208229808379563, 0.004577788366631496, 0.008806711820564311, 0.01617541948878527, 0.02180831149382254, 0.025662843334127498, 0.029194036962662945, 0.03149144004628842, 0.030900071474762602, 0.02104676491610224, 0.008113236445321807, 0.0007530376774105715];

Bit_length = Bit_length + 1;

subplot(2,3,2);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(b) Forwarding label length (bits), 704 nodes');
ylabel('PMF');




%Figure for 1440 nodes

%h=fig('units','centimeters','width',13,'height',9,'font','Helvetica','fontsize', 12);

Bit_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60];
KeyFlowPMF = [0.0, 0.0, 0.0, 0.0, 2.0999359519534653e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0999359519534653e-06, 4.1998719039069305e-06, 1.2599615711720792e-05, 1.4699551663674258e-05, 4.4098654991022774e-05, 7.979756617423169e-05, 9.869698974181287e-05, 0.00017219474806018416, 0.00016589494020432377, 0.00013229596497306832, 0.00014489558068478913, 9.239718188595248e-05, 5.249839879883664e-05, 0.00011339654140548713, 0.00020159385138753268, 0.0004304868701504604, 0.0008966726514841297, 0.0018521435096229566, 0.0037210865068615408, 0.00735607563969299, 0.01460925441774026, 0.028628426832981595, 0.048983106015266537, 0.07693745340767107, 0.10407702565071765, 0.12636364590879978, 0.14191157169706323, 0.14831007654266545, 0.13539337050219968, 0.09907707814911645, 0.04862401696748249, 0.01138585273149169, 0.00010919666950158021, 0.0];
OursRPMF   = [0.0, 0.0, 0.0, 0.0, 0.0, 2.0999359519534653e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0999359519534653e-06, 0.0, 6.299807855860396e-06, 1.4699551663674258e-05, 2.309929547148812e-05, 5.4598334750790104e-05, 0.00010709673354962674, 0.0002561921861383228, 0.0004010877668231119, 0.00025829212209027623, 0.00021419346709925348, 0.0005417834756039941, 0.0009806700895622683, 0.0019109417162776535, 0.0037735849056603774, 0.007475771988954337, 0.015004042376707511, 0.030106781743156834, 0.06043615669722074, 0.12147919488455602, 0.2394493967933978, 0.31246626977877173, 0.09958316271353723, 0.0016358501065717496, 2.0999359519534653e-06, 8.399743807813861e-06, 1.4699551663674258e-05, 1.2599615711720792e-05, 5.4598334750790104e-05, 8.189750212618515e-05, 0.00020789365924339307, 0.0003905880870633446, 0.0007664766224630149, 0.0015014542056467277, 0.0028160141115695972, 0.005161642569901618, 0.007975556745519261, 0.01100996419609202, 0.013349292846568179, 0.014707951407482071, 0.015820917462017407, 0.014399260822544913, 0.009903297949412544, 0.004609359414537857, 0.0010142690647935238, 8.399743807813861e-06];

Bit_length = Bit_length + 1;

subplot(2,3,3);
plot(Bit_length,KeyFlowPMF,'--+','LineWidth',1);
hold on
plot(Bit_length,OursRPMF,'-s','LineWidth',1);
hold on

grid on

legend('KeyFlow','KeySet','Location','northwest');
xlabel('(c) Forwarding label length (bits), 1440 nodes');
ylabel('PMF');
